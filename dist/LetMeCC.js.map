{"version":3,"sources":["webpack:///./src/tracker/trackerData.ts","webpack:///./src/tracker/index.ts","webpack:///./src/tools/autoClickTracker.ts","webpack:///./src/utils/uuid.ts","webpack:///./src/globel/data.ts","webpack:///./src/LetMeCC.ts"],"names":["extendStatics","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","TrackerData","_trackerData","set","params","AutoClickTracker","options","track","_this","_options","document","addEventListener","e","checkEvent","assembleParams","opt","validate","indexOf","target","nodeName","attrs","attrValidate","flag","checkAttrs","attributes","ele","customerParams","elementType","elementClassName","undefined","className","baseVal","elementID","id","elementContent","innerText","elementUrl","href","elementPath","el","Element","path","unfinish","nodeType","Node","ELEMENT_NODE","selector","toLowerCase","unshift","sib","nth","previousElementSibling","elClassName","replace","RegExp","parentNode","join","getSelecter","$url","location","__extends","d","b","setPrototypeOf","__proto__","Array","TypeError","String","__","constructor","create","Tracker","_super","name","cipher","globelData","Error","_name","_cipher","_globelData","systemEvents","eventName","reqType","pageData","queryParams","type","pageParams","trackerParams","eventParams","console","log","UUID","pre","random","arr","Uint32Array","window","crypto","getRandomValues","Math","floor","toString","init","title","referrer","Date","uuid","get","$version","$title","$referrer","$pageInitTime","$pageId","LetMeCC","_tracks","setTrackData","reset","LetMeCCInstance","functionName","_a","args","_i"],"mappings":"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","file":"LetMeCC.js","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar TrackerData = /** @class */ (function () {\n    function TrackerData() {\n        this._trackerData = {};\n    }\n    ;\n    TrackerData.prototype.set = function (params) {\n        this._trackerData = __assign(__assign({}, this._trackerData), params);\n    };\n    return TrackerData;\n}());\nexport { TrackerData };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { TrackerData } from './trackerData';\nimport { AutoClickTracker } from '../tools/autoClickTracker';\nvar Tracker = /** @class */ (function (_super) {\n    __extends(Tracker, _super);\n    function Tracker(name, cipher, options, globelData) {\n        var _this = _super.call(this) || this;\n        if (!name || !cipher) {\n            throw new Error(\"\\n                \" + (name ? '' : 'tracker name is required') + \"\\n                \" + (cipher ? '' : 'tracker cipher is required') + \"\\n            \");\n        }\n        _this._name = name;\n        _this._cipher = cipher;\n        _this._options = options;\n        _this._globelData = globelData;\n        _this.systemEvents();\n        return _this;\n    }\n    ;\n    Tracker.prototype.track = function (eventName, params, reqType) {\n        if (reqType === void 0) { reqType = 'img'; }\n        var pageData = this._globelData['get']();\n        var queryParams = {\n            type: 'track',\n            cipher: this._cipher,\n            pageParams: pageData,\n            trackerParams: this._trackerData,\n            eventParams: params\n        };\n        console.log(eventName, queryParams, reqType);\n    };\n    ;\n    Tracker.prototype.systemEvents = function () {\n        if (!this._options['prevent_pageview']) {\n            this.track('$pageview', {});\n        }\n        if (!this._options['prevent_pageclose']) {\n            this.track('$pageclose', {}, 'beacon');\n        }\n        if (this._options['autoTrack']) {\n            new AutoClickTracker(this._options['autoTrack'], this.track);\n        }\n    };\n    ;\n    return Tracker;\n}(TrackerData));\nexport { Tracker };\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar AutoClickTracker = /** @class */ (function () {\n    function AutoClickTracker(options, track) {\n        var _this = this;\n        this._options = options;\n        document.addEventListener('click', function (e) {\n            _this.checkEvent(e) && track('$autoClick', _this.assembleParams(e));\n        });\n    }\n    ;\n    AutoClickTracker.prototype.checkEvent = function (e) {\n        var opt = this._options;\n        if (!opt['attrs']) {\n            opt['attrs'] = [];\n        }\n        var validate = true;\n        var checkAttrs = function (attrs) {\n            var attrValidate = false;\n            var flag = 0;\n            for (flag; flag < attrs.length; flag++) {\n                opt['attrs'].indexOf(attrs[flag]) > -1 && (attrValidate = true);\n            }\n            return attrValidate;\n        };\n        validate = validate && opt['elements'].indexOf(e.target.nodeName) > -1;\n        validate = validate || checkAttrs(e.target.attributes);\n        validate = validate && (opt['pageFilter'] ? opt['pageFilter']() : true);\n        validate = validate && (opt['elementFilter'] ? opt['elementFilter'](e.target) : true);\n        return validate;\n    };\n    ;\n    AutoClickTracker.prototype.assembleParams = function (e) {\n        var getSelecter = function (el) {\n            if (!(el instanceof Element))\n                return;\n            var path = [];\n            var unfinish = false;\n            while (el && el.nodeType === Node.ELEMENT_NODE && el.nodeName !== 'BODY') {\n                var selector = el.nodeName.toLowerCase();\n                if (el.id) {\n                    selector += '#' + el.id;\n                    path.unshift(selector);\n                    break;\n                }\n                else {\n                    var sib = el, nth = 1;\n                    while (sib = sib.previousElementSibling) {\n                        if (sib.nodeName.toLowerCase() == selector)\n                            nth++;\n                    }\n                    if (nth != 1) {\n                        selector += \":nth-of-type(\" + nth + \")\";\n                    }\n                    var elClassName = el.className.baseVal !== undefined ? el.className.baseVal : el.className;\n                    selector += elClassName ? '.' + elClassName.replace(new RegExp(/( )/g), '.') : '';\n                }\n                path.unshift(selector);\n                if (!el.parentNode) {\n                    unfinish = true;\n                }\n                el = el.parentNode;\n            }\n            path.unshift(unfinish ? \"body...\" : \"body\");\n            return path.join(\" > \");\n        };\n        var ele = e.target;\n        var customerParams = (this._options['customProperty'] ? this._options['customProperty'](ele) : {}) || {};\n        return __assign(__assign({}, customerParams), { elementType: ele.nodeName, elementClassName: (ele.className.baseVal !== undefined ? ele.className.baseVal : ele.className) || '', elementID: ele.id || '', elementContent: ele.innerText || '', elementUrl: ele.href || '', elementPath: getSelecter(ele), $url: document.location.href });\n    };\n    ;\n    return AutoClickTracker;\n}());\nexport { AutoClickTracker };\n;\n","var UUID = /** @class */ (function () {\n    function UUID() {\n    }\n    ;\n    UUID.prototype.create = function (pre) {\n        var random;\n        try {\n            var arr = new Uint32Array(1);\n            window.crypto.getRandomValues(arr);\n            random = arr[0] & 2079910271;\n        }\n        catch (b) {\n            random = Math.floor(Math.random() * 2079910271);\n        }\n        return pre + '·' + random.toString(36);\n    };\n    return UUID;\n}());\n;\nexport default new UUID();\n","import uuid from '../utils/uuid';\nvar globelData = /** @class */ (function () {\n    function globelData() {\n        this.init();\n    }\n    ;\n    globelData.prototype.init = function () {\n        this['$url'] = document.location.href;\n        this['$title'] = document.title;\n        this['$referrer'] = document.referrer;\n        this['$pageInitTime'] = new Date();\n        this['$pageId'] = uuid.create('pid');\n    };\n    ;\n    globelData.prototype.get = function () {\n        return {\n            $version: this['$version'],\n            $url: this['$url'],\n            $title: this['$title'],\n            $referrer: this['$referrer'],\n            $pageInitTime: this['$pageInitTime'],\n            $pageId: this['$pageId']\n        };\n    };\n    return globelData;\n}());\nexport { globelData };\n","import { Tracker } from './tracker/index';\nimport { globelData } from './globel/data';\nvar LetMeCC = /** @class */ (function () {\n    function LetMeCC() {\n        this._tracks = {};\n        this._globelData = new globelData();\n    }\n    ;\n    LetMeCC.prototype.init = function (name, cipher, options) {\n        this._tracks[name] = new Tracker(name, cipher, options, this._globelData);\n    };\n    ;\n    LetMeCC.prototype.track = function (name, eventName, params, reqType) {\n        if (this._tracks[name]) {\n            this._tracks[name].track(eventName, params, reqType);\n        }\n        else {\n            throw new Error(\"Tracker \" + name + \" does not exist\");\n        }\n    };\n    ;\n    LetMeCC.prototype.setTrackData = function (name, params) {\n        this._tracks[name].set(params);\n    };\n    ;\n    LetMeCC.prototype.reset = function () {\n        this._globelData && this._globelData['init']();\n    };\n    return LetMeCC;\n}());\nwindow.LetMeCCInstance = new LetMeCC();\nwindow.LetMeCC = function (functionName) {\n    var _a;\n    var args = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n    }\n    try {\n        (_a = window.LetMeCCInstance)[functionName].apply(_a, args);\n    }\n    catch (e) {\n        console.log(e);\n    }\n};\n"],"sourceRoot":""}